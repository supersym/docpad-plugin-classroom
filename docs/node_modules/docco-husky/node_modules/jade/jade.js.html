<!DOCTYPE html><html><head><title>jade.js</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../../.././test/a.js.html" class="source "><span class="base_path">. / test / </span><span class="file_name">a.js</span></a><a href="../../../../.././node_modules/docco-husky/lib/docco.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / lib / </span><span class="file_name">docco.js</span></a><a href="../../../../.././node_modules/docco-husky/test/Foo.java.html" class="source "><span class="base_path">. / node_modules / docco-husky / test / </span><span class="file_name">Foo.java</span></a><a href="../../../../.././node_modules/docco-husky/test/test.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / test / </span><span class="file_name">test.js</span></a><a href="../../../../.././node_modules/docco-husky/vendor/showdown.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / vendor / </span><span class="file_name">showdown.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/runtime.min.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / </span><span class="file_name">runtime.min.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/testing/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / testing / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/lexer.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">lexer.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/doctypes.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">doctypes.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/jade.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">jade.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/doctype.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">doctype.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/code.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">code.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/case.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">case.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/block.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">block.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/text.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">text.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/tag.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">tag.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/filter.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">filter.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/block-comment.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">block-comment.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/each.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">each.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/mixin.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">mixin.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/literal.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">literal.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/node.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">node.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/nodes/comment.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / nodes / </span><span class="file_name">comment.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/parser.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">parser.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/compiler.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">compiler.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/utils.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">utils.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/runtime.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">runtime.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/inline-tags.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">inline-tags.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/filters.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">filters.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/lib/self-closing.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / lib / </span><span class="file_name">self-closing.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/jade.js.html" class="source selected"><span class="base_path">. / node_modules / docco-husky / node_modules / jade / </span><span class="file_name">jade.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/runtime.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / </span><span class="file_name">runtime.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/jade.min.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / </span><span class="file_name">jade.min.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/commander/lib/commander.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / commander / lib / </span><span class="file_name">commander.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/commander/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / commander / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/race.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">race.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/clobber.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">clobber.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/sync.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">sync.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/return_sync.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">return_sync.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/root.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">root.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/umask_sync.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">umask_sync.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/rel.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">rel.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/return.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">return.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/mkdirp.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">mkdirp.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/perm_sync.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">perm_sync.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/perm.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">perm.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/chmod.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">chmod.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/test/umask.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / test / </span><span class="file_name">umask.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/jade/node_modules/mkdirp/examples/pow.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / jade / node_modules / mkdirp / examples / </span><span class="file_name">pow.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/walk/node-type-emitter.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / walk / </span><span class="file_name">node-type-emitter.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/walk/walk-async-only.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / walk / </span><span class="file_name">walk-async-only.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/walk/node_modules/forEachAsync/node_modules/sequence/sequence.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / walk / node_modules / forEachAsync / node_modules / sequence / </span><span class="file_name">sequence.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/walk/node_modules/forEachAsync/forEachAsync.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / walk / node_modules / forEachAsync / </span><span class="file_name">forEachAsync.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/walk/walk.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / walk / </span><span class="file_name">walk.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/gravatar/lib/gravatar.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / gravatar / lib / </span><span class="file_name">gravatar.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/gravatar/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / gravatar / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/gravatar/test/gravatar.test.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / gravatar / test / </span><span class="file_name">gravatar.test.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/lib/utils.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / lib / </span><span class="file_name">utils.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/lib/dox.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / lib / </span><span class="file_name">dox.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/node_modules/commander/lib/commander.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / node_modules / commander / lib / </span><span class="file_name">commander.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/node_modules/commander/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / node_modules / commander / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/node_modules/github-flavored-markdown/scripts/showdown.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / node_modules / github-flavored-markdown / scripts / </span><span class="file_name">showdown.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/node_modules/github-flavored-markdown/scripts/preview.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / node_modules / github-flavored-markdown / scripts / </span><span class="file_name">preview.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/dox/node_modules/github-flavored-markdown/code.rb.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / dox / node_modules / github-flavored-markdown / </span><span class="file_name">code.rb</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/scope.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">scope.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/helpers.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">helpers.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/lexer.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">lexer.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/repl.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">repl.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/rewriter.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">rewriter.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/parser.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">parser.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/cake.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">cake.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/grammar.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">grammar.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/coffee-script.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">coffee-script.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/command.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">command.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/nodes.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">nodes.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/browser.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">browser.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/coffee-script/lib/coffee-script/optparse.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / coffee-script / lib / coffee-script / </span><span class="file_name">optparse.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/underscore/index.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / underscore / </span><span class="file_name">index.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/underscore/underscore-min.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / underscore / </span><span class="file_name">underscore-min.js</span></a><a href="../../../../.././node_modules/docco-husky/node_modules/underscore/underscore.js.html" class="source "><span class="base_path">. / node_modules / docco-husky / node_modules / underscore / </span><span class="file_name">underscore.js</span></a><a href="../../../../.././node_modules/docco-husky/src/docco.coffee.html" class="source "><span class="base_path">. / node_modules / docco-husky / src / </span><span class="file_name">docco.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>jade.js</h1><div class="filepath">./node_modules/docco-husky/node_modules/jade/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>CommonJS require()</p>
</td><td class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">require</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">mod</span> <span class="o">=</span> <span class="nx">require</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">path</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mod</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;failed to require &quot;&#39;</span> <span class="o">+</span> <span class="nx">p</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mod</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">mod</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="nx">mod</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">mod</span><span class="p">,</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="nx">path</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">exports</span><span class="p">;</span>
  <span class="p">}</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">modules</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">resolve</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">path</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">orig</span> <span class="o">=</span> <span class="nx">path</span>
      <span class="p">,</span> <span class="nx">reg</span> <span class="o">=</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;.js&#39;</span>
      <span class="p">,</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;/index.js&#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">require</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">reg</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">reg</span>
      <span class="o">||</span> <span class="nx">require</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span>
      <span class="o">||</span> <span class="nx">orig</span><span class="p">;</span>
  <span class="p">};</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
    <span class="nx">require</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">path</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
  <span class="p">};</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">relative</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">!=</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">return</span> <span class="nx">require</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
      
      <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="p">,</span> <span class="nx">segs</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">path</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
      
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">segs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">seg</span> <span class="o">=</span> <span class="nx">segs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;..&#39;</span> <span class="o">==</span> <span class="nx">seg</span><span class="p">)</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">!=</span> <span class="nx">seg</span><span class="p">)</span> <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">seg</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">require</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>
    <span class="p">};</span>
  <span class="p">};</span>


<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;compiler.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - Compiler<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#97;&#x69;&#108;&#116;&#111;:&#116;&#x6A;&#x40;&#118;&#105;s&#x69;&#111;&#110;&#x2D;&#109;e&#x64;&#x69;a&#x2E;&#x63;&#x61;">&#116;&#x6A;&#x40;&#118;&#105;s&#x69;&#111;&#110;&#x2D;&#109;e&#x64;&#x69;a&#x2E;&#x63;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./nodes&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">filters</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./filters&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">doctypes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./doctypes&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">selfClosing</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./self-closing&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">inlineTags</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./inline-tags&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">utils</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./utils&#39;</span><span class="p">);</span>

 
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
   <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
     <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
     <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
         <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
       <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
   <span class="p">}</span> 
 <span class="p">}</span>
 
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trimLeft</span><span class="p">)</span> <span class="p">{</span>
   <span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trimLeft</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
     <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
   <span class="p">}</span>
 <span class="p">}</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize <code>Compiler</code> with the given <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Compiler</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Compiler</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledDoctype</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledTag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">pp</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">pretty</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kc">false</span> <span class="o">!==</span> <span class="nx">options</span><span class="p">.</span><span class="nx">compileDebug</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">indents</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">doctype</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">setDoctype</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">doctype</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Compiler prototype.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Compiler</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  </pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Compile parse tree to JavaScript.</p></div><div class="details"><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">compile</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var interp;&#39;</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastBufferedIdx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the default doctype <code>name</code>. Sets terse mode to <code>true</code> when<br />html 5 is used, causing self-closing tags to end with ">" vs "/>",<br />and boolean attributes are not mirrored.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">string</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">setDoctype</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">doctype</span> <span class="o">=</span> <span class="nx">doctypes</span><span class="p">[(</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;default&#39;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()];</span>
    <span class="nx">doctype</span> <span class="o">=</span> <span class="nx">doctype</span> <span class="o">||</span> <span class="s1">&#39;&lt;!DOCTYPE &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">doctype</span> <span class="o">=</span> <span class="nx">doctype</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">terse</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span> <span class="o">==</span> <span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;html&#39;</span> <span class="o">==</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">xml</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">doctype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;&lt;?xml&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Buffer the given <code>str</code> optionally escaped.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>esc </span><span class="dox_type">Boolean</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">buffer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">esc</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">esc</span><span class="p">)</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastBufferedIdx</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">lastBuffered</span> <span class="o">+=</span> <span class="nx">str</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">lastBufferedIdx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;buf.push(&#39;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBuffered</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;buf.push(&#39;&quot;</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">lastBuffered</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">lastBufferedIdx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">}</span>    
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visit</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">debug</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">debug</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">debug</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;__.unshift({ lineno: &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">line</span>
        <span class="o">+</span> <span class="s1">&#39;, filename: &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">filename</span>
          <span class="o">?</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
          <span class="o">:</span> <span class="s1">&#39;__[0].filename&#39;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s1">&#39; });&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>Massive hack to fix our context
stack for - else[ if] etc</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="kc">false</span> <span class="o">===</span> <span class="nx">node</span><span class="p">.</span><span class="nx">debug</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">debug</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">visitNode</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">debug</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;__.shift();&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitNode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">||</span> <span class="nx">node</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">match</span><span class="p">(</span><span class="sr">/function ([^(\s]+)()/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="s1">&#39;visit&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">](</span><span class="nx">node</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit case <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Literal</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">visitCase</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">withinCase</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">withinCase</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;switch (&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">expr</span> <span class="o">+</span> <span class="s1">&#39;){&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">withinCase</span> <span class="o">=</span> <span class="nx">_</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit when <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Literal</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">visitWhen</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;default&#39;</span> <span class="o">==</span> <span class="nx">node</span><span class="p">.</span><span class="nx">expr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;default:&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;case &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">expr</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;  break;&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit literal <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Literal</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">visitLiteral</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\\\n&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit all nodes in <code>block</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">visitBlock</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">block</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">block</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">block</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>doctype</code>. Sets terse mode to <code>true</code> when html 5<br />is used, causing self-closing tags to end with ">" vs "/>",<br />and boolean attributes are not mirrored.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>doctype </span><span class="dox_type">Doctype</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitDoctype</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doctype</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doctype</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">doctype</span><span class="p">.</span><span class="nx">val</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">doctype</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setDoctype</span><span class="p">(</span><span class="nx">doctype</span><span class="p">.</span><span class="nx">val</span> <span class="o">||</span> <span class="s1">&#39;default&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">doctype</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">doctype</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledDoctype</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>mixin</code>, generating a function that<br />may be called within the template.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>mixin </span><span class="dox_type">Mixin</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">visitMixin</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mixin</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mixin&#39;</span>
      <span class="p">,</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">.</span><span class="nx">args</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">mixin</span><span class="p">.</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;var &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; = function(&#39;</span> <span class="o">+</span> <span class="nx">args</span> <span class="o">+</span> <span class="s1">&#39;){&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">mixin</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">args</span> <span class="o">+</span> <span class="s1">&#39;);&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>tag</code> buffering tag markup, generating<br />attributes, visiting the <code>tag</code>'s code and block.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>tag </span><span class="dox_type">Tag</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitTag</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tag</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">indents</span><span class="o">++</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledTag</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledDoctype</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;html&#39;</span> <span class="o">==</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">visitDoctype</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">hasCompiledTag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>pretty print</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pp</span> <span class="o">&amp;&amp;</span> <span class="nx">inlineTags</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span> <span class="o">+</span> <span class="nb">Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indents</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="nx">selfClosing</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">xml</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visitAttributes</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">terse</span>
        <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
        <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;/&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><p>Optimize attributes buffering</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">visitAttributes</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">code</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">visitCode</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">code</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">trimLeft</span><span class="p">()));</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="s1">&#39;pre&#39;</span> <span class="o">==</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><p>pretty print</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pp</span> <span class="o">&amp;&amp;</span> <span class="o">!~</span><span class="nx">inlineTags</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span> <span class="o">+</span> <span class="nb">Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indents</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">));</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;/&#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">indents</span><span class="o">--</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>filter</code>, throwing when the filter does not exist.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>filter </span><span class="dox_type">Filter</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">filter</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">filters</span><span class="p">[</span><span class="nx">filter</span><span class="p">.</span><span class="nx">name</span><span class="p">];</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>unknown filter</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">isASTFilter</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;unknown ast filter &quot;&#39;</span> <span class="o">+</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;:&quot;&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;unknown filter &quot;:&#39;</span> <span class="o">+</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">isASTFilter</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fn</span><span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">block</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">attrs</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">fn</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">attrs</span><span class="p">)));</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>text</code> node.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>text </span><span class="dox_type">Text</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitText</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">){</span>
    <span class="nx">text</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">escape</span><span class="p">)</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit a <code>comment</code>, only buffering when the buffer flag is set.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>comment </span><span class="dox_type">Comment</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitComment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">comment</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">comment</span><span class="p">.</span><span class="nx">buffer</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pp</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span> <span class="o">+</span> <span class="nb">Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indents</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;!--&#39;</span> <span class="o">+</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">val</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;--&gt;&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit a <code>BlockComment</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>comment </span><span class="dox_type">Comment</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitBlockComment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">comment</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">comment</span><span class="p">.</span><span class="nx">buffer</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;if&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;!--[&#39;</span> <span class="o">+</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;]&gt;&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;![endif]--&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;&lt;!--&#39;</span> <span class="o">+</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">val</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="s1">&#39;--&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>code</code>, respecting buffer / escape flags.<br />If the code is followed by a block, wrap it in<br />a self-calling function.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>code </span><span class="dox_type">Code</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitCode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">code</span><span class="p">){</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><p>Wrap code blocks with {}.
we only wrap unbuffered code blocks ATM
since they are usually flow control</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><p>Buffer code</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">code</span><span class="p">.</span><span class="nx">val</span><span class="p">.</span><span class="nx">trimLeft</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;var __val__ = &#39;</span> <span class="o">+</span> <span class="nx">val</span><span class="p">);</span>
      <span class="nx">val</span> <span class="o">=</span> <span class="s1">&#39;null == __val__ ? &quot;&quot; : __val__&#39;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">escape</span><span class="p">)</span> <span class="nx">val</span> <span class="o">=</span> <span class="s1">&#39;escape(&#39;</span> <span class="o">+</span> <span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;buf.push(&quot;</span> <span class="o">+</span> <span class="nx">val</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><p>Block support</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">code</span><span class="p">.</span><span class="nx">buffer</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">code</span><span class="p">.</span><span class="nx">buffer</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>each</code> block.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>each </span><span class="dox_type">Each</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitEach</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">each</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;// iterate &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;(function(){\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;  if (\&#39;number\&#39; == typeof &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;.length) {\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;    for (var &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39; = 0, $$l = &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;.length; &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39; &lt; $$l; &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;++) {\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;      var &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;];\n&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">each</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;    }\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;  } else {\n&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;    for (var &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39; in &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;) {\n&#39;</span>
       <span class="o">+</span> <span class="s1">&#39;      if (&#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;.hasOwnProperty(&#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;)){&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;      var &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">obj</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nx">each</span><span class="p">.</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;];\n&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="nx">each</span><span class="p">.</span><span class="nx">block</span><span class="p">);</span>

     <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;      }\n&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;   }\n  }\n}).call(this);\n&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Visit <code>attrs</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>attrs </span><span class="dox_type">Array</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">visitAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">buf</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="p">,</span> <span class="nx">classes</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">terse</span><span class="p">)</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;terse: true&#39;</span><span class="p">);</span>

    <span class="nx">attrs</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;class&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">classes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;&#39;:(&quot;</span> <span class="o">+</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
        <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pair</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">classes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">classes</span> <span class="o">=</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; + &#39; &#39; + &quot;</span><span class="p">);</span>
      <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;class: &quot;</span> <span class="o">+</span> <span class="nx">classes</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">buf</span> <span class="o">=</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;class:&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;class&quot;:&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;buf.push(attrs({ &quot;</span> <span class="o">+</span> <span class="nx">buf</span> <span class="o">+</span> <span class="s2">&quot; }));&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Escape the given string of <code>html</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>html </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
  <span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;(?!\w+;)/g</span><span class="p">,</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;quot;&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">});</span> <span class="c1">// module: compiler.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;doctypes.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - doctypes<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#97;&#x69;&#x6C;&#116;&#x6F;:&#x74;&#x6A;&#64;&#118;&#x69;&#x73;&#x69;&#x6F;&#x6E;&#x2D;&#x6D;&#101;&#x64;&#105;&#x61;&#46;&#99;&#97;">&#x74;&#x6A;&#64;&#118;&#x69;&#x73;&#x69;&#x6F;&#x6E;&#x2D;&#x6D;&#101;&#x64;&#105;&#x61;&#46;&#99;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;5&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;xml&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;transitional&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;frameset&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;1.1&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;basic&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML Basic 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd&quot;&gt;&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;mobile&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;!DOCTYPE html PUBLIC &quot;-//WAPFORUM//DTD XHTML Mobile 1.2//EN&quot; &quot;http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd&quot;&gt;&#39;</span>
<span class="p">};</span>
<span class="p">});</span> <span class="c1">// module: doctypes.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;filters.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - filters<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#x61;i&#108;&#x74;&#x6F;:&#116;&#x6A;&#64;&#118;&#105;&#115;&#105;&#x6F;&#x6E;&#45;&#109;e&#100;&#x69;&#97;&#46;&#x63;&#97;">&#116;&#x6A;&#64;&#118;&#105;&#115;&#105;&#x6F;&#x6E;&#45;&#109;e&#100;&#x69;&#97;&#46;&#x63;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  </pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Wrap text with CDATA block.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">cdata</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;![CDATA[\\n&#39;</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;\\n]]&gt;&#39;</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Transform sass to css, wrapped in style tags.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">sass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\n/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sass</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sass&#39;</span><span class="p">).</span><span class="nx">render</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">sass</span> <span class="o">+</span> <span class="s1">&#39;&lt;/style&gt;&#39;</span><span class="p">;</span> 
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Transform stylus to css, wrapped in style tags.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">stylus</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\n/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">stylus</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;stylus&#39;</span><span class="p">);</span>
    <span class="nx">stylus</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">).</span><span class="nx">render</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">css</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
      <span class="nx">ret</span> <span class="o">=</span> <span class="nx">css</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">ret</span> <span class="o">+</span> <span class="s1">&#39;&lt;/style&gt;&#39;</span><span class="p">;</span> 
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-40"><td class="docs"><div class="pilwrap"><a href="#section-40" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Transform less to css, wrapped in style tags.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">less</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\n/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;less&#39;</span><span class="p">).</span><span class="nx">render</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">css</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
      <span class="nx">ret</span> <span class="o">=</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">css</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/style&gt;&#39;</span><span class="p">;</span>  
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-41"><td class="docs"><div class="pilwrap"><a href="#section-41" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Transform markdown to html.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">markdown</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">md</span><span class="p">;</span></pre></div></td></tr><tr id="section-42"><td class="docs"><div class="pilwrap"><a href="#section-42" class="pilcrow">&#182;</a></div><p>support markdown / discount</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">md</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;markdown&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="nx">md</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;discount&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="nx">md</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;markdown-js&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Cannot find markdown library, install markdown or discount&#39;</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\n/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">md</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span><span class="s1">&#39;&amp;#39;&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-43"><td class="docs"><div class="pilwrap"><a href="#section-43" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Transform coffeescript to javascript.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">coffeescript</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\n/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;coffee-script&#39;</span><span class="p">).</span><span class="nx">compile</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;script type=&quot;text/javascript&quot;&gt;\\n&#39;</span> <span class="o">+</span> <span class="nx">js</span> <span class="o">+</span> <span class="s1">&#39;&lt;/script&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: filters.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;inline-tags.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-44"><td class="docs"><div class="pilwrap"><a href="#section-44" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - inline tags<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#x61;&#105;&#108;&#116;&#x6F;:&#116;j&#64;&#118;i&#x73;i&#x6F;n&#45;m&#x65;&#x64;ia&#46;&#99;&#x61;">&#116;j&#64;&#118;i&#x73;i&#x6F;n&#45;m&#x65;&#x64;ia&#46;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;a&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;abbr&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;acronym&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;b&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;br&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;code&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;em&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;font&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;i&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;img&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;ins&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;kbd&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;map&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;samp&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;small&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;span&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;strong&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;sub&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;sup&#39;</span>
<span class="p">];</span>
<span class="p">});</span> <span class="c1">// module: inline-tags.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;jade.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-45"><td class="docs"><div class="pilwrap"><a href="#section-45" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#97;&#x69;&#108;&#116;&#111;:&#116;&#x6A;&#64;&#x76;is&#x69;o&#110;&#45;&#x6D;&#x65;&#x64;&#x69;&#97;&#46;&#x63;&#97;">&#116;&#x6A;&#64;&#x76;is&#x69;o&#110;&#45;&#x6D;&#x65;&#x64;&#x69;&#97;&#46;&#x63;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-46"><td class="docs"><div class="pilwrap"><a href="#section-46" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Parser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./parser&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">Lexer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./lexer&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">Compiler</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./compiler&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">runtime</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./runtime&#39;</span><span class="p">)</span></pre></div></td></tr><tr id="section-47"><td class="docs"><div class="pilwrap"><a href="#section-47" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Library version.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s1">&#39;0.17.0&#39;</span><span class="p">;</span></pre></div></td></tr><tr id="section-48"><td class="docs"><div class="pilwrap"><a href="#section-48" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Expose self closing tags.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">selfClosing</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./self-closing&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-49"><td class="docs"><div class="pilwrap"><a href="#section-49" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Default supported doctypes.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">doctypes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./doctypes&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-50"><td class="docs"><div class="pilwrap"><a href="#section-50" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Text filters.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./filters&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-51"><td class="docs"><div class="pilwrap"><a href="#section-51" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Utilities.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">utils</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./utils&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-52"><td class="docs"><div class="pilwrap"><a href="#section-52" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Expose <code>Compiler</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">Compiler</span> <span class="o">=</span> <span class="nx">Compiler</span><span class="p">;</span></pre></div></td></tr><tr id="section-53"><td class="docs"><div class="pilwrap"><a href="#section-53" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Expose <code>Parser</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">Parser</span> <span class="o">=</span> <span class="nx">Parser</span><span class="p">;</span></pre></div></td></tr><tr id="section-54"><td class="docs"><div class="pilwrap"><a href="#section-54" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Expose <code>Lexer</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">Lexer</span> <span class="o">=</span> <span class="nx">Lexer</span><span class="p">;</span></pre></div></td></tr><tr id="section-55"><td class="docs"><div class="pilwrap"><a href="#section-55" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Nodes.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">nodes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./nodes&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-56"><td class="docs"><div class="pilwrap"><a href="#section-56" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade runtime helpers.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">runtime</span> <span class="o">=</span> <span class="nx">runtime</span><span class="p">;</span></pre></div></td></tr><tr id="section-57"><td class="docs"><div class="pilwrap"><a href="#section-57" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Template function cache.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-58"><td class="docs"><div class="pilwrap"><a href="#section-58" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Parse the given <code>str</code> of jade and return a function body.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
  <span class="k">try</span> <span class="p">{</span></pre></div></td></tr><tr id="section-59"><td class="docs"><div class="pilwrap"><a href="#section-59" class="pilcrow">&#182;</a></div><p>Parse</p>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Parser</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></pre></div></td></tr><tr id="section-60"><td class="docs"><div class="pilwrap"><a href="#section-60" class="pilcrow">&#182;</a></div><p>Compile</p>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">compiler</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">compiler</span> <span class="o">||</span> <span class="nx">Compiler</span><span class="p">)(</span><span class="nx">parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(),</span> <span class="nx">options</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">js</span> <span class="o">=</span> <span class="nx">compiler</span><span class="p">.</span><span class="nx">compile</span><span class="p">();</span></pre></div></td></tr><tr id="section-61"><td class="docs"><div class="pilwrap"><a href="#section-61" class="pilcrow">&#182;</a></div><p>Debug compiler</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">debug</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;\nCompiled Function:\n\n\033[90m%s\033[0m&#39;</span><span class="p">,</span> <span class="nx">js</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^/gm</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span>
      <span class="o">+</span> <span class="s1">&#39;var buf = [];\n&#39;</span>
      <span class="o">+</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">self</span>
        <span class="o">?</span> <span class="s1">&#39;var self = locals || {};\n&#39;</span> <span class="o">+</span> <span class="nx">js</span>
        <span class="o">:</span> <span class="s1">&#39;with (locals || {}) {\n&#39;</span> <span class="o">+</span> <span class="nx">js</span> <span class="o">+</span> <span class="s1">&#39;\n}\n&#39;</span><span class="p">)</span>
      <span class="o">+</span> <span class="s1">&#39;return buf.join(&quot;&quot;);&#39;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">parser</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">context</span><span class="p">();</span>
    <span class="nx">runtime</span><span class="p">.</span><span class="nx">rethrow</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">lineno</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div></td></tr><tr id="section-62"><td class="docs"><div class="pilwrap"><a href="#section-62" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Compile a <code>Function</code> representation of the given jade <code>str</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Options</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Function</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"><h2>Options</h2>

<ul>
<li><code>compileDebug</code> when <code>false</code> debugging code is stripped from the compiled template</li>
<li><code>client</code> when <code>true</code> the helper functions <code>escape()</code> etc will reference <code>jade.escape()</code>
 for use with the Jade client-side runtime.js</li>
</ul></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">compile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{}</span>
    <span class="p">,</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">client</span>
    <span class="p">,</span> <span class="nx">filename</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filename</span>
      <span class="o">?</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span>
      <span class="o">:</span> <span class="s1">&#39;undefined&#39;</span>
    <span class="p">,</span> <span class="nx">fn</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">compileDebug</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;var __ = [{ lineno: 1, filename: &#39;</span> <span class="o">+</span> <span class="nx">filename</span> <span class="o">+</span> <span class="s1">&#39; }];&#39;</span>
      <span class="p">,</span> <span class="s1">&#39;try {&#39;</span>
      <span class="p">,</span> <span class="nx">parse</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">str</span><span class="p">),</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{})</span>
      <span class="p">,</span> <span class="s1">&#39;} catch (err) {&#39;</span>
      <span class="p">,</span> <span class="s1">&#39;  rethrow(err, __[0].filename, __[0].lineno);&#39;</span>
      <span class="p">,</span> <span class="s1">&#39;}&#39;</span>
    <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">parse</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">str</span><span class="p">),</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{});</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="s1">&#39;var attrs = jade.attrs, escape = jade.escape, rethrow = jade.rethrow;\n&#39;</span> <span class="o">+</span> <span class="nx">fn</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">fn</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;locals, attrs, escape, rethrow&#39;</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">client</span><span class="p">)</span> <span class="k">return</span> <span class="nx">fn</span><span class="p">;</span>

  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">locals</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">locals</span><span class="p">,</span> <span class="nx">runtime</span><span class="p">.</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">runtime</span><span class="p">.</span><span class="nx">escape</span><span class="p">,</span> <span class="nx">runtime</span><span class="p">.</span><span class="nx">rethrow</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-63"><td class="docs"><div class="pilwrap"><a href="#section-63" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Render the given <code>str</code> of jade and invoke<br />the callback <code>fn(err, str)</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span><span class="dox_type">Function</span><span>- or fn</span></div><div class="dox_tag_detail"><span>fn </span><span class="dox_type">Function</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"><h2>Options</h2>

<ul>
<li><code>cache</code> enable template caching</li>
<li><code>filename</code> filename required for <code>include</code> / <code>extends</code> and caching</li>
</ul></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span></pre></div></td></tr><tr id="section-64"><td class="docs"><div class="pilwrap"><a href="#section-64" class="pilcrow">&#182;</a></div><p>swap args</p>
</td><td class="code"><div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;function&#39;</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="p">}</span></pre></div></td></tr><tr id="section-65"><td class="docs"><div class="pilwrap"><a href="#section-65" class="pilcrow">&#182;</a></div><p>cache requires .filename</p>
</td><td class="code"><div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">cache</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;the &quot;filename&quot; option is required for caching&#39;</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filename</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">tmpl</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">cache</span>
      <span class="o">?</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">path</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">path</span><span class="p">]</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span>
      <span class="o">:</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="nx">fn</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">tmpl</span><span class="p">(</span><span class="nx">options</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-66"><td class="docs"><div class="pilwrap"><a href="#section-66" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Render a Jade file at the given <code>path</code> and callback <code>fn(err, str)</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>path </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span><span class="dox_type">Function</span><span>- or callback</span></div><div class="dox_tag_detail"><span>fn </span><span class="dox_type">Function</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">renderFile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;:string&#39;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;function&#39;</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="p">}</span>

  <span class="nx">options</span><span class="p">.</span><span class="nx">filename</span> <span class="o">=</span> <span class="nx">path</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">cache</span>
    <span class="o">?</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">))</span>
    <span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">);</span>

  <span class="nx">exports</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-67"><td class="docs"><div class="pilwrap"><a href="#section-67" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Express support.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">__express</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">renderFile</span><span class="p">;</span>
<span class="p">});</span> <span class="c1">// module: jade.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;lexer.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-68"><td class="docs"><div class="pilwrap"><a href="#section-68" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - Lexer<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#97;&#105;&#108;&#x74;&#111;:&#116;&#106;&#x40;&#118;&#x69;&#115;&#105;&#111;&#x6E;&#x2D;&#109;&#x65;d&#105;&#97;&#46;&#x63;&#97;">&#116;&#106;&#x40;&#118;&#x69;&#115;&#105;&#111;&#x6E;&#x2D;&#109;&#x65;d&#105;&#97;&#46;&#x63;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-69"><td class="docs"><div class="pilwrap"><a href="#section-69" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize <code>Lexer</code> with the given <code>str</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"><h2>Options</h2>

<ul>
<li><code>colons</code> allow colons for attr delimiters</li>
</ul></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Lexer</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Lexer</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\r\n|\r/g</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">colons</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">colons</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">deferredTokens</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">lastIndents</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">lineno</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">stash</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">indentRe</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">pipeless</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-70"><td class="docs"><div class="pilwrap"><a href="#section-70" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Lexer prototype.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Lexer</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  </pre></div></td></tr><tr id="section-71"><td class="docs"><div class="pilwrap"><a href="#section-71" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Construct a token with the given <code>type</code> and <code>val</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>type </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">tok</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">val</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">type</span>
      <span class="p">,</span> <span class="nx">line</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">lineno</span>
      <span class="p">,</span> <span class="nx">val</span><span class="o">:</span> <span class="nx">val</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-72"><td class="docs"><div class="pilwrap"><a href="#section-72" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Consume the given <code>len</code> of input.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>len </span><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">consume</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">len</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">len</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-73"><td class="docs"><div class="pilwrap"><a href="#section-73" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Scan for <code>type</code> with the given <code>regexp</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>type </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>regexp </span><span class="dox_type">RegExp</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">scan</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">regexp</span><span class="p">,</span> <span class="nx">type</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="nx">regexp</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-74"><td class="docs"><div class="pilwrap"><a href="#section-74" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Defer the given <code>tok</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>tok </span><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">defer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tok</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">deferredTokens</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tok</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-75"><td class="docs"><div class="pilwrap"><a href="#section-75" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Lookahead <code>n</code> tokens.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>n </span><span class="dox_type">Number</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">lookahead</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">fetch</span><span class="o">--</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">());</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">[</span><span class="o">--</span><span class="nx">n</span><span class="p">];</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-76"><td class="docs"><div class="pilwrap"><a href="#section-76" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return the indexOf <code>start</code> / <code>end</code> delimiters.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>start </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>end </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">indexOfDelimiters</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span>
      <span class="p">,</span> <span class="nx">nstart</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="p">,</span> <span class="nx">nend</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="p">,</span> <span class="nx">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">start</span> <span class="o">==</span> <span class="nx">str</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
        <span class="o">++</span><span class="nx">nstart</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">end</span> <span class="o">==</span> <span class="nx">str</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nx">nend</span> <span class="o">==</span> <span class="nx">nstart</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">pos</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">pos</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-77"><td class="docs"><div class="pilwrap"><a href="#section-77" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Stashed token.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">stashed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">length</span>
      <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-78"><td class="docs"><div class="pilwrap"><a href="#section-78" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deferred token.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">deferred</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deferredTokens</span><span class="p">.</span><span class="nx">length</span> 
      <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">deferredTokens</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-79"><td class="docs"><div class="pilwrap"><a href="#section-79" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>end-of-source.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">eos</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;outdent&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;eos&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-80"><td class="docs"><div class="pilwrap"><a href="#section-80" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Comment.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">comment</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^ *\/\/(-)?([^\n]*)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">!=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-81"><td class="docs"><div class="pilwrap"><a href="#section-81" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Tag.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">tag</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^(\w[-:\w]*)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">tok</span><span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;:&#39;</span> <span class="o">==</span> <span class="nx">name</span><span class="p">[</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">defer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">));</span>
        <span class="k">while</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-82"><td class="docs"><div class="pilwrap"><a href="#section-82" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Filter.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">filter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^:(\w+)/</span><span class="p">,</span> <span class="s1">&#39;filter&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-83"><td class="docs"><div class="pilwrap"><a href="#section-83" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Doctype.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">doctype</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^(?:!!!|doctype) *([^\n]+)?/</span><span class="p">,</span> <span class="s1">&#39;doctype&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-84"><td class="docs"><div class="pilwrap"><a href="#section-84" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Id.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">id</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^#([\w-]+)/</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-85"><td class="docs"><div class="pilwrap"><a href="#section-85" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Class.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">className</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^\.([\w-]+)/</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-86"><td class="docs"><div class="pilwrap"><a href="#section-86" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Text.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">text</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^(?:\| ?)?([^\n]+)/</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-87"><td class="docs"><div class="pilwrap"><a href="#section-87" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Extends.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="kr">extends</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^extends +([^\n]+)/</span><span class="p">,</span> <span class="s1">&#39;extends&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-88"><td class="docs"><div class="pilwrap"><a href="#section-88" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Block.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">block</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^block +([^\n]+)/</span><span class="p">,</span> <span class="s1">&#39;block&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-89"><td class="docs"><div class="pilwrap"><a href="#section-89" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Include.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">include</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^include +([^\n]+)/</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-90"><td class="docs"><div class="pilwrap"><a href="#section-90" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Case.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="k">case</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^case +([^\n]+)/</span><span class="p">,</span> <span class="s1">&#39;case&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-91"><td class="docs"><div class="pilwrap"><a href="#section-91" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>When.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">when</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^when +([^:\n]+)/</span><span class="p">,</span> <span class="s1">&#39;when&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-92"><td class="docs"><div class="pilwrap"><a href="#section-92" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Default.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="k">default</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^default */</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-93"><td class="docs"><div class="pilwrap"><a href="#section-93" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Assignment.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">assignment</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^(\w+) += *([^;\n]+)( *;? *)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">,</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;var &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; = (&#39;</span> <span class="o">+</span> <span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;);&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-94"><td class="docs"><div class="pilwrap"><a href="#section-94" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Mixin.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">mixin</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^mixin +([-\w]+)(?:\((.*)\))?/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;mixin&#39;</span><span class="p">,</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">args</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-95"><td class="docs"><div class="pilwrap"><a href="#section-95" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Conditional.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">conditional</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^(if|unless|else if|else)\b([^\n]*)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">,</span> <span class="nx">js</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

      <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">&#39;if&#39;</span><span class="o">:</span> <span class="nx">js</span> <span class="o">=</span> <span class="s1">&#39;if (&#39;</span> <span class="o">+</span> <span class="nx">js</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;unless&#39;</span><span class="o">:</span> <span class="nx">js</span> <span class="o">=</span> <span class="s1">&#39;if (!(&#39;</span> <span class="o">+</span> <span class="nx">js</span> <span class="o">+</span> <span class="s1">&#39;))&#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;else if&#39;</span><span class="o">:</span> <span class="nx">js</span> <span class="o">=</span> <span class="s1">&#39;else if (&#39;</span> <span class="o">+</span> <span class="nx">js</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;else&#39;</span><span class="o">:</span> <span class="nx">js</span> <span class="o">=</span> <span class="s1">&#39;else&#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="nx">js</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-96"><td class="docs"><div class="pilwrap"><a href="#section-96" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>While.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="k">while</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^while +([^\n]+)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;while (&#39;</span> <span class="o">+</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-97"><td class="docs"><div class="pilwrap"><a href="#section-97" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Each.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^(?:- *)?(?:each|for) +(\w+)(?: *, *(\w+))? * in *([^\n]+)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;each&#39;</span><span class="p">,</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;$index&#39;</span><span class="p">;</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">code</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-98"><td class="docs"><div class="pilwrap"><a href="#section-98" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Code.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">code</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="sr">/^(!?=|-)([^\n]+)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">captures</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">flags</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
      <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="nx">flags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;=&#39;</span><span class="p">;</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">flags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;=&#39;</span> <span class="o">||</span> <span class="nx">flags</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;=&#39;</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-99"><td class="docs"><div class="pilwrap"><a href="#section-99" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Attributes.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">attrs</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOfDelimiters</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">,</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;attrs&#39;</span><span class="p">)</span>
        <span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">length</span>
        <span class="p">,</span> <span class="nx">colons</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">colons</span>
        <span class="p">,</span> <span class="nx">states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span>
        <span class="p">,</span> <span class="nx">key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="p">,</span> <span class="nx">val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="p">,</span> <span class="nx">quote</span>
        <span class="p">,</span> <span class="nx">c</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nx">state</span><span class="p">(){</span>
        <span class="k">return</span> <span class="nx">states</span><span class="p">[</span><span class="nx">states</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/#\{([^}]+)\}/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">expr</span><span class="p">){</span>
          <span class="k">return</span> <span class="nx">quote</span> <span class="o">+</span> <span class="s2">&quot; + (&quot;</span> <span class="o">+</span> <span class="nx">expr</span> <span class="o">+</span> <span class="s2">&quot;) + &quot;</span> <span class="o">+</span> <span class="nx">quote</span><span class="p">;</span>
        <span class="p">});</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
      <span class="nx">tok</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="p">{};</span>

      <span class="kd">function</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">real</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span></pre></div></td></tr><tr id="section-100"><td class="docs"><div class="pilwrap"><a href="#section-100" class="pilcrow">&#182;</a></div><p>TODO: remove when people fix ":"</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">colons</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;:&#39;</span> <span class="o">==</span> <span class="nx">c</span><span class="p">)</span> <span class="nx">c</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span><span class="p">;</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s1">&#39;,&#39;</span><span class="o">:</span>
          <span class="k">case</span> <span class="s1">&#39;\n&#39;</span><span class="o">:</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">state</span><span class="p">())</span> <span class="p">{</span>
              <span class="k">case</span> <span class="s1">&#39;expr&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;array&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;string&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;object&#39;</span><span class="o">:</span>
                <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">);</span>
                <span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
                <span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">==</span> <span class="nx">key</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="nx">tok</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^[&#39;&quot;]|[&#39;&quot;]$/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">==</span> <span class="nx">val</span>
                  <span class="o">?</span> <span class="kc">true</span>
                  <span class="o">:</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
                <span class="nx">key</span> <span class="o">=</span> <span class="nx">val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;=&#39;</span><span class="o">:</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">state</span><span class="p">())</span> <span class="p">{</span>
              <span class="k">case</span> <span class="s1">&#39;key char&#39;</span><span class="o">:</span>
                <span class="nx">key</span> <span class="o">+=</span> <span class="nx">real</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">case</span> <span class="s1">&#39;val&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;expr&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;array&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;string&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;object&#39;</span><span class="o">:</span>
                <span class="nx">val</span> <span class="o">+=</span> <span class="nx">real</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;(&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;val&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">()</span>
              <span class="o">||</span> <span class="s1">&#39;expr&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;expr&#39;</span><span class="p">);</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;)&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;expr&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">()</span>
              <span class="o">||</span> <span class="s1">&#39;val&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;{&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;val&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">);</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;}&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;[&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;val&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">);</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;]&#39;</span><span class="o">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;array&#39;</span> <span class="o">==</span> <span class="nx">state</span><span class="p">())</span> <span class="nx">states</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
            <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">:</span>
          <span class="k">case</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">state</span><span class="p">())</span> <span class="p">{</span>
              <span class="k">case</span> <span class="s1">&#39;key&#39;</span><span class="o">:</span>
                <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;key char&#39;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">case</span> <span class="s1">&#39;key char&#39;</span><span class="o">:</span>
                <span class="nx">states</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">case</span> <span class="s1">&#39;string&#39;</span><span class="o">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">c</span> <span class="o">==</span> <span class="nx">quote</span><span class="p">)</span> <span class="nx">states</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
                <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="nx">states</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">);</span>
                <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
                <span class="nx">quote</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;&#39;</span><span class="o">:</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">state</span><span class="p">())</span> <span class="p">{</span>
              <span class="k">case</span> <span class="s1">&#39;key&#39;</span><span class="o">:</span>
              <span class="k">case</span> <span class="s1">&#39;key char&#39;</span><span class="o">:</span>
                <span class="nx">key</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="nx">val</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">parse</span><span class="p">(</span><span class="nx">str</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>

      <span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-101"><td class="docs"><div class="pilwrap"><a href="#section-101" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Indent | Outdent | Newline.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">indent</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">captures</span><span class="p">,</span> <span class="nx">re</span><span class="p">;</span></pre></div></td></tr><tr id="section-102"><td class="docs"><div class="pilwrap"><a href="#section-102" class="pilcrow">&#182;</a></div><p>established regexp</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indentRe</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">captures</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indentRe</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">);</span></pre></div></td></tr><tr id="section-103"><td class="docs"><div class="pilwrap"><a href="#section-103" class="pilcrow">&#182;</a></div><p>determine regexp</p>
</td><td class="code"><div class="highlight"><pre>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-104"><td class="docs"><div class="pilwrap"><a href="#section-104" class="pilcrow">&#182;</a></div><p>tabs</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">re</span> <span class="o">=</span> <span class="sr">/^\n(\t*) */</span><span class="p">;</span>
      <span class="nx">captures</span> <span class="o">=</span> <span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">);</span></pre></div></td></tr><tr id="section-105"><td class="docs"><div class="pilwrap"><a href="#section-105" class="pilcrow">&#182;</a></div><p>spaces</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">re</span> <span class="o">=</span> <span class="sr">/^\n( *)/</span><span class="p">;</span>
        <span class="nx">captures</span> <span class="o">=</span> <span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">);</span>
      <span class="p">}</span></pre></div></td></tr><tr id="section-106"><td class="docs"><div class="pilwrap"><a href="#section-106" class="pilcrow">&#182;</a></div><p>established</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">&amp;&amp;</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">indentRe</span> <span class="o">=</span> <span class="nx">re</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">tok</span>
        <span class="p">,</span> <span class="nx">indents</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>

      <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">lineno</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">indents</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;\t&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Invalid indentation, you can use tabs or spaces but not both&#39;</span><span class="p">);</span>
      <span class="p">}</span></pre></div></td></tr><tr id="section-107"><td class="docs"><div class="pilwrap"><a href="#section-107" class="pilcrow">&#182;</a></div><p>blank line</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;\n&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;newline&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-108"><td class="docs"><div class="pilwrap"><a href="#section-108" class="pilcrow">&#182;</a></div><p>outdent</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">indents</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">indents</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;outdent&#39;</span><span class="p">));</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stash</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span></pre></div></td></tr><tr id="section-109"><td class="docs"><div class="pilwrap"><a href="#section-109" class="pilcrow">&#182;</a></div><p>indent</p>
</td><td class="code"><div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">indents</span> <span class="o">&amp;&amp;</span> <span class="nx">indents</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">indentStack</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">indents</span><span class="p">);</span>
        <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">,</span> <span class="nx">indents</span><span class="p">);</span></pre></div></td></tr><tr id="section-110"><td class="docs"><div class="pilwrap"><a href="#section-110" class="pilcrow">&#182;</a></div><p>newline</p>
</td><td class="code"><div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;newline&#39;</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">tok</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-111"><td class="docs"><div class="pilwrap"><a href="#section-111" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Pipe-less text consumed only when <br />pipeless is true;</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">pipelessText</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pipeless</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;\n&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">return</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">i</span><span class="p">)</span> <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">consume</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="nx">str</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-112"><td class="docs"><div class="pilwrap"><a href="#section-112" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>':'</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">colon</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/^: */</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-113"><td class="docs"><div class="pilwrap"><a href="#section-113" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return the next token object, or those<br />previously stashed by lookahead.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">advance</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stashed</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-114"><td class="docs"><div class="pilwrap"><a href="#section-114" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return the next token object.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deferred</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">eos</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">pipelessText</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">doctype</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="k">case</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">when</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="k">default</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="kr">extends</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixin</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditional</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="k">while</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">assignment</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">tag</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">code</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">indent</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">comment</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">colon</span><span class="p">()</span>
      <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: lexer.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/block-comment.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-115"><td class="docs"><div class="pilwrap"><a href="#section-115" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - BlockComment<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#97;&#105;&#x6C;&#116;o:&#x74;&#106;&#x40;&#x76;&#105;&#115;&#105;&#x6F;&#110;&#x2D;&#109;&#x65;&#x64;&#x69;&#x61;.&#x63;&#x61;">&#x74;&#106;&#x40;&#x76;&#105;&#115;&#105;&#x6F;&#110;&#x2D;&#109;&#x65;&#x64;&#x69;&#x61;.&#x63;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-116"><td class="docs"><div class="pilwrap"><a href="#section-116" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-117"><td class="docs"><div class="pilwrap"><a href="#section-117" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>BlockComment</code> with the given <code>block</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span></div><div class="dox_tag_detail"><span>buffer </span><span class="dox_type">Boolean</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">BlockComment</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">BlockComment</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-118"><td class="docs"><div class="pilwrap"><a href="#section-118" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">BlockComment</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">BlockComment</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">BlockComment</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/block-comment.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/block.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-119"><td class="docs"><div class="pilwrap"><a href="#section-119" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Block<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#x61;i&#x6C;&#x74;&#111;:&#116;&#106;&#64;&#118;&#105;&#115;&#105;&#x6F;n&#45;&#109;&#x65;&#100;&#105;&#97;&#46;&#99;&#97;">&#116;&#106;&#64;&#118;&#105;&#115;&#105;&#x6F;n&#45;&#109;&#x65;&#100;&#105;&#97;&#46;&#99;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-120"><td class="docs"><div class="pilwrap"><a href="#section-120" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-121"><td class="docs"><div class="pilwrap"><a href="#section-121" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a new <code>Block</code> with an optional <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Block</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Block</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-122"><td class="docs"><div class="pilwrap"><a href="#section-122" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Block</span><span class="p">;</span></pre></div></td></tr><tr id="section-123"><td class="docs"><div class="pilwrap"><a href="#section-123" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Replace the nodes in <code>other</code> with the nodes<br />in <code>this</code> block.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>other </span><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">replace</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">other</span><span class="p">){</span>
  <span class="nx">other</span><span class="p">.</span><span class="nx">nodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-124"><td class="docs"><div class="pilwrap"><a href="#section-124" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Pust the given <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-125"><td class="docs"><div class="pilwrap"><a href="#section-125" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Check if this block is empty.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Boolean</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="mi">0</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-126"><td class="docs"><div class="pilwrap"><a href="#section-126" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Unshift the given <code>node</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unshift</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-127"><td class="docs"><div class="pilwrap"><a href="#section-127" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return the "last" block.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Block</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">lastBlock</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="k">this</span>
    <span class="p">,</span> <span class="nx">node</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodes</span><span class="p">)</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">lastBlock</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">block</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">node</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">lastBlock</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">last</span><span class="p">;</span>
<span class="p">};</span>


<span class="p">});</span> <span class="c1">// module: nodes/block.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/case.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-128"><td class="docs"><div class="pilwrap"><a href="#section-128" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Case<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#x61;&#105;l&#116;&#111;:&#116;&#106;&#64;&#118;&#x69;s&#x69;&#x6F;n&#45;&#x6D;&#x65;&#100;&#x69;&#97;&#46;&#99;&#x61;">&#116;&#106;&#64;&#118;&#x69;s&#x69;&#x6F;n&#45;&#x6D;&#x65;&#100;&#x69;&#97;&#46;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-129"><td class="docs"><div class="pilwrap"><a href="#section-129" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-130"><td class="docs"><div class="pilwrap"><a href="#section-130" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a new <code>Case</code> with <code>expr</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>expr </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Case</span> <span class="o">=</span> <span class="nx">exports</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Case</span><span class="p">(</span><span class="nx">expr</span><span class="p">,</span> <span class="nx">block</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">expr</span> <span class="o">=</span> <span class="nx">expr</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-131"><td class="docs"><div class="pilwrap"><a href="#section-131" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Case</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Case</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Case</span><span class="p">;</span>


<span class="kd">var</span> <span class="nx">When</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">When</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">When</span><span class="p">(</span><span class="nx">expr</span><span class="p">,</span> <span class="nx">block</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">expr</span> <span class="o">=</span> <span class="nx">expr</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-132"><td class="docs"><div class="pilwrap"><a href="#section-132" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">When</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">When</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">When</span><span class="p">;</span>



<span class="p">});</span> <span class="c1">// module: nodes/case.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/code.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-133"><td class="docs"><div class="pilwrap"><a href="#section-133" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Code<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#x61;&#x69;&#108;&#116;&#111;:&#116;&#x6A;&#x40;&#118;&#x69;&#x73;&#105;&#111;&#110;&#x2D;&#x6D;&#x65;&#x64;&#105;&#x61;&#46;&#99;a">&#116;&#x6A;&#x40;&#118;&#x69;&#x73;&#105;&#111;&#110;&#x2D;&#x6D;&#x65;&#x64;&#105;&#x61;&#46;&#99;a</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-134"><td class="docs"><div class="pilwrap"><a href="#section-134" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-135"><td class="docs"><div class="pilwrap"><a href="#section-135" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Code</code> node with the given code <code>val</code>.<br />Code may also be optionally buffered and escaped.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>buffer </span><span class="dox_type">Boolean</span></div><div class="dox_tag_detail"><span>escape </span><span class="dox_type">Boolean</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Code</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Code</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">,</span> <span class="nx">escape</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="nx">escape</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^ *else/</span><span class="p">))</span> <span class="k">this</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-136"><td class="docs"><div class="pilwrap"><a href="#section-136" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Code</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Code</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Code</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/code.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/comment.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-137"><td class="docs"><div class="pilwrap"><a href="#section-137" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Comment<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#x61;&#x69;&#108;&#x74;&#111;:&#116;&#106;&#64;v&#x69;&#115;&#x69;&#111;&#110;&#x2D;&#109;&#x65;&#x64;&#105;&#x61;&#46;&#99;&#x61;">&#116;&#106;&#64;v&#x69;&#115;&#x69;&#111;&#110;&#x2D;&#109;&#x65;&#x64;&#105;&#x61;&#46;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-138"><td class="docs"><div class="pilwrap"><a href="#section-138" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-139"><td class="docs"><div class="pilwrap"><a href="#section-139" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Comment</code> with the given <code>val</code>, optionally <code>buffer</code>,<br />otherwise the comment may render in the output.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>buffer </span><span class="dox_type">Boolean</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Comment</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Comment</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-140"><td class="docs"><div class="pilwrap"><a href="#section-140" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Comment</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Comment</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Comment</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/comment.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/doctype.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-141"><td class="docs"><div class="pilwrap"><a href="#section-141" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Doctype<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#97;&#105;&#x6C;&#x74;&#x6F;:&#x74;&#106;&#64;&#118;i&#x73;&#x69;&#x6F;&#110;&#45;&#x6D;&#101;&#x64;&#x69;&#97;&#46;&#x63;&#x61;">&#x74;&#106;&#64;&#118;i&#x73;&#x69;&#x6F;&#110;&#45;&#x6D;&#101;&#x64;&#x69;&#97;&#46;&#x63;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-142"><td class="docs"><div class="pilwrap"><a href="#section-142" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-143"><td class="docs"><div class="pilwrap"><a href="#section-143" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Doctype</code> with the given <code>val</code>. </p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Doctype</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Doctype</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-144"><td class="docs"><div class="pilwrap"><a href="#section-144" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Doctype</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Doctype</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Doctype</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/doctype.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/each.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-145"><td class="docs"><div class="pilwrap"><a href="#section-145" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Each<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#97;&#x69;&#x6C;&#116;&#x6F;:&#x74;&#106;&#64;&#118;&#x69;&#x73;&#105;&#x6F;&#x6E;&#45;&#x6D;&#x65;&#100;&#105;&#97;&#x2E;&#99;a">&#x74;&#106;&#64;&#118;&#x69;&#x73;&#105;&#x6F;&#x6E;&#45;&#x6D;&#x65;&#100;&#105;&#97;&#x2E;&#99;a</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-146"><td class="docs"><div class="pilwrap"><a href="#section-146" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-147"><td class="docs"><div class="pilwrap"><a href="#section-147" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize an <code>Each</code> node, representing iteration</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>obj </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>key </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Each</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-148"><td class="docs"><div class="pilwrap"><a href="#section-148" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Each</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Each</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Each</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/each.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/filter.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-149"><td class="docs"><div class="pilwrap"><a href="#section-149" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Filter<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;a&#x69;&#108;&#x74;&#x6F;:&#x74;&#106;&#64;&#x76;&#105;&#115;&#105;&#111;&#x6E;&#45;m&#101;&#100;&#105;&#97;&#x2E;&#x63;a">&#x74;&#106;&#64;&#x76;&#105;&#115;&#105;&#111;&#x6E;&#45;m&#101;&#100;&#105;&#97;&#x2E;&#x63;a</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-150"><td class="docs"><div class="pilwrap"><a href="#section-150" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">Block</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./block&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-151"><td class="docs"><div class="pilwrap"><a href="#section-151" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Filter</code> node with the given <br />filter <code>name</code> and <code>block</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span><span class="dox_type">Node</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Filter</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Filter</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">isASTFilter</span> <span class="o">=</span> <span class="nx">block</span> <span class="k">instanceof</span> <span class="nx">Block</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-152"><td class="docs"><div class="pilwrap"><a href="#section-152" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Filter</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Filter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Filter</span><span class="p">;</span>

<span class="p">});</span> <span class="c1">// module: nodes/filter.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/index.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-153"><td class="docs"><div class="pilwrap"><a href="#section-153" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#x61;&#x69;&#108;&#116;&#x6F;:&#116;&#x6A;&#x40;&#118;&#x69;&#x73;&#x69;&#111;&#110;&#x2D;&#109;&#101;&#100;&#105;&#x61;.&#x63;&#x61;">&#116;&#x6A;&#x40;&#118;&#x69;&#x73;&#x69;&#111;&#110;&#x2D;&#109;&#101;&#100;&#105;&#x61;.&#x63;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Tag</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./tag&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Code</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./code&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Each</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./each&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Case</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./case&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./text&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Block</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./block&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Mixin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./mixin&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Filter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./filter&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Comment</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./comment&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Literal</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./literal&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">BlockComment</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./block-comment&#39;</span><span class="p">);</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">Doctype</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./doctype&#39;</span><span class="p">);</span>

<span class="p">});</span> <span class="c1">// module: nodes/index.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/literal.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-154"><td class="docs"><div class="pilwrap"><a href="#section-154" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Literal<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#97;&#x69;&#x6C;t&#111;:&#x74;&#106;&#x40;&#x76;&#105;&#x73;&#x69;&#x6F;&#110;&#x2D;&#x6D;&#101;&#x64;&#105;a&#x2E;&#99;&#x61;">&#x74;&#106;&#x40;&#x76;&#105;&#x73;&#x69;&#x6F;&#110;&#x2D;&#x6D;&#101;&#x64;&#105;a&#x2E;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-155"><td class="docs"><div class="pilwrap"><a href="#section-155" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-156"><td class="docs"><div class="pilwrap"><a href="#section-156" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Literal</code> node with the given `str.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Literal</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Literal</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s2">&quot;\\n&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span> <span class="s2">&quot;\\&#39;&quot;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-157"><td class="docs"><div class="pilwrap"><a href="#section-157" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Literal</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Literal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Literal</span><span class="p">;</span>


<span class="p">});</span> <span class="c1">// module: nodes/literal.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/mixin.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-158"><td class="docs"><div class="pilwrap"><a href="#section-158" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Mixin<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#97;&#x69;l&#116;&#x6F;:&#116;&#106;&#x40;&#118;&#x69;s&#105;o&#x6E;&#x2D;&#109;&#x65;&#x64;&#x69;&#x61;&#x2E;&#x63;a">&#116;&#106;&#x40;&#118;&#x69;s&#105;o&#x6E;&#x2D;&#109;&#x65;&#x64;&#x69;&#x61;&#x2E;&#x63;a</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-159"><td class="docs"><div class="pilwrap"><a href="#section-159" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-160"><td class="docs"><div class="pilwrap"><a href="#section-160" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a new <code>Mixin</code> with <code>name</code> and <code>block</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>args </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Mixin</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Mixin</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">block</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">args</span> <span class="o">=</span> <span class="nx">args</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-161"><td class="docs"><div class="pilwrap"><a href="#section-161" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Mixin</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Mixin</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Mixin</span><span class="p">;</span>



<span class="p">});</span> <span class="c1">// module: nodes/mixin.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/node.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-162"><td class="docs"><div class="pilwrap"><a href="#section-162" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Node<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#97;&#x69;&#x6C;&#x74;&#x6F;:&#116;&#106;&#x40;v&#105;&#x73;i&#111;&#110;&#45;&#x6D;&#101;&#100;&#105;&#97;&#46;&#x63;&#97;">&#116;&#106;&#x40;v&#105;&#x73;i&#111;&#110;&#45;&#x6D;&#101;&#100;&#105;&#97;&#46;&#x63;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-163"><td class="docs"><div class="pilwrap"><a href="#section-163" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Node</code>.</p></div><div class="details"><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Node</span><span class="p">(){};</span>
<span class="p">});</span> <span class="c1">// module: nodes/node.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/tag.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-164"><td class="docs"><div class="pilwrap"><a href="#section-164" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Tag<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#x61;&#105;&#x6C;&#116;&#111;:&#116;&#x6A;&#64;v&#105;&#x73;&#105;&#x6F;&#x6E;&#x2D;&#109;ed&#x69;&#x61;&#46;&#99;&#97;">&#116;&#x6A;&#64;v&#105;&#x73;&#105;&#x6F;&#x6E;&#x2D;&#109;ed&#x69;&#x61;&#46;&#99;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-165"><td class="docs"><div class="pilwrap"><a href="#section-165" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">),</span>
    <span class="nx">Block</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./block&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-166"><td class="docs"><div class="pilwrap"><a href="#section-166" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Tag</code> node with the given tag <code>name</code> and optional <code>block</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>block </span><span class="dox_type">Block</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Tag</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Tag</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span> <span class="o">||</span> <span class="k">new</span> <span class="nx">Block</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-167"><td class="docs"><div class="pilwrap"><a href="#section-167" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Tag</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Tag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Tag</span><span class="p">;</span></pre></div></td></tr><tr id="section-168"><td class="docs"><div class="pilwrap"><a href="#section-168" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Set attribute <code>name</code> to <code>val</code>, keep in mind these become<br />part of a raw js object literal, so to quote a value you must<br />'"quote me"', otherwise or example 'user.name' is literal JavaScript.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>val </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Tag</span><span>for chaining</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Tag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="o">:</span> <span class="nx">val</span> <span class="p">});</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-169"><td class="docs"><div class="pilwrap"><a href="#section-169" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Remove attribute <code>name</code> when present.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Tag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">==</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-170"><td class="docs"><div class="pilwrap"><a href="#section-170" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Get attribute value by <code>name</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Tag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">==</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: nodes/tag.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;nodes/text.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-171"><td class="docs"><div class="pilwrap"><a href="#section-171" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - nodes - Text<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#97;i&#x6C;&#x74;o:&#x74;j&#64;&#x76;&#x69;&#x73;&#105;&#x6F;&#110;&#45;&#x6D;e&#x64;&#105;&#97;&#x2E;&#x63;&#97;">&#x74;j&#64;&#x76;&#x69;&#x73;&#105;&#x6F;&#110;&#45;&#x6D;e&#x64;&#105;&#97;&#x2E;&#x63;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-172"><td class="docs"><div class="pilwrap"><a href="#section-172" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Node</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./node&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-173"><td class="docs"><div class="pilwrap"><a href="#section-173" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize a <code>Text</code> node with optional <code>line</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>line </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Text</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Text</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">line</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-174"><td class="docs"><div class="pilwrap"><a href="#section-174" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Inherit from <code>Node</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Text</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">;</span>
<span class="nx">Text</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Text</span><span class="p">;</span></pre></div></td></tr><tr id="section-175"><td class="docs"><div class="pilwrap"><a href="#section-175" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Push the given <code>node.</code></p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>node </span><span class="dox_type">Node</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Text</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: nodes/text.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;parser.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-176"><td class="docs"><div class="pilwrap"><a href="#section-176" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - Parser<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#x61;&#105;&#108;&#x74;&#x6F;:&#116;&#x6A;&#64;&#118;&#105;&#x73;&#105;&#111;&#110;&#45;&#x6D;&#x65;&#x64;i&#97;&#46;&#99;&#x61;">&#116;&#x6A;&#64;&#118;&#105;&#x73;&#105;&#111;&#110;&#45;&#x6D;&#x65;&#x64;i&#97;&#46;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-177"><td class="docs"><div class="pilwrap"><a href="#section-177" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Module dependencies.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Lexer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./lexer&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./nodes&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-178"><td class="docs"><div class="pilwrap"><a href="#section-178" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initialize <code>Parser</code> with the given input <code>str</code> and <code>filename</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>filename </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>options </span><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Parser</span> <span class="o">=</span> <span class="nx">exports</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Parser</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">filename</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Lexer</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">filename</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">blocks</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">contexts</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">];</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-179"><td class="docs"><div class="pilwrap"><a href="#section-179" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Tags that may not contain tags.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">textOnly</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">textOnly</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span> <span class="s1">&#39;textarea&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">];</span></pre></div></td></tr><tr id="section-180"><td class="docs"><div class="pilwrap"><a href="#section-180" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Parser prototype.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Parser</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-181"><td class="docs"><div class="pilwrap"><a href="#section-181" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Push <code>parser</code> onto the context stack,<br />or pop and return a <code>Parser</code>.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">context</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parser</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">parser</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">contexts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">parser</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contexts</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-182"><td class="docs"><div class="pilwrap"><a href="#section-182" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return the next token object.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">advance</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-183"><td class="docs"><div class="pilwrap"><a href="#section-183" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Skip <code>n</code> tokens.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>n </span><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">skip</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">n</span><span class="o">--</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-184"><td class="docs"><div class="pilwrap"><a href="#section-184" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Single token lookahead.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">peek</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-185"><td class="docs"><div class="pilwrap"><a href="#section-185" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return lexer lineno.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Number</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">line</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">lineno</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-186"><td class="docs"><div class="pilwrap"><a href="#section-186" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p><code>n</code> token lookahead.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>n </span><span class="dox_type">Number</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">lookahead</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-187"><td class="docs"><div class="pilwrap"><a href="#section-187" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Parse input returning a string of js for evaluation.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">public</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parse</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Block</span><span class="p">,</span> <span class="nx">parser</span><span class="p">;</span>
    <span class="nx">block</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>

    <span class="k">while</span> <span class="p">(</span><span class="s1">&#39;eos&#39;</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;newline&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">block</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parseExpr</span><span class="p">());</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">parser</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">extending</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">(</span><span class="nx">parser</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">();</span>
      <span class="k">return</span> <span class="nx">ast</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">block</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-188"><td class="docs"><div class="pilwrap"><a href="#section-188" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Expect the given type, or throw an exception.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>type </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">expect</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;expected &quot;&#39;</span> <span class="o">+</span> <span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;&quot;, but got &quot;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-189"><td class="docs"><div class="pilwrap"><a href="#section-189" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Accept the given <code>type</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>type </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">accept</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-190"><td class="docs"><div class="pilwrap"><a href="#section-190" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>tag<br />| doctype<br />| mixin<br />| include<br />| filter<br />| comment<br />| text<br />| each<br />| code<br />| id<br />| class</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseExpr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s1">&#39;tag&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseTag</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;mixin&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseMixin</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;block&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseBlock</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;case&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseCase</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;when&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseWhen</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;default&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseDefault</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;extends&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseExtends</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;include&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseInclude</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;doctype&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseDoctype</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;filter&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseFilter</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;comment&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseComment</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;text&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseText</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;each&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseEach</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;code&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseCode</span><span class="p">();</span>
      <span class="k">case</span> <span class="s1">&#39;id&#39;</span><span class="o">:</span>
      <span class="k">case</span> <span class="s1">&#39;class&#39;</span><span class="o">:</span>
        <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">defer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">tok</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;div&#39;</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">defer</span><span class="p">(</span><span class="nx">tok</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseExpr</span><span class="p">();</span>
      <span class="k">default</span><span class="o">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;unexpected token &quot;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-191"><td class="docs"><div class="pilwrap"><a href="#section-191" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Text</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseText</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Text</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-192"><td class="docs"><div class="pilwrap"><a href="#section-192" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>':' expr<br />| block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseBlockExpansion</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;:&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Block</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parseExpr</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-193"><td class="docs"><div class="pilwrap"><a href="#section-193" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>case</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseCase</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;case&#39;</span><span class="p">).</span><span class="nx">val</span>
      <span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Case</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-194"><td class="docs"><div class="pilwrap"><a href="#section-194" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>when</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseWhen</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;when&#39;</span><span class="p">).</span><span class="nx">val</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Case</span><span class="p">.</span><span class="nx">When</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseBlockExpansion</span><span class="p">());</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-195"><td class="docs"><div class="pilwrap"><a href="#section-195" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>default</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseDefault</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Case</span><span class="p">.</span><span class="nx">When</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseBlockExpansion</span><span class="p">());</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-196"><td class="docs"><div class="pilwrap"><a href="#section-196" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>code</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseCode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Code</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">escape</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">block</span>
      <span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;newline&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">)</span> <span class="o">++</span><span class="nx">i</span><span class="p">;</span>
    <span class="nx">block</span> <span class="o">=</span> <span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">skip</span><span class="p">(</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
      <span class="nx">node</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-197"><td class="docs"><div class="pilwrap"><a href="#section-197" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>comment</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseComment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">node</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">BlockComment</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">(),</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Comment</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-198"><td class="docs"><div class="pilwrap"><a href="#section-198" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>doctype</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseDoctype</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;doctype&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Doctype</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-199"><td class="docs"><div class="pilwrap"><a href="#section-199" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>filter attrs? text-block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">block</span>
      <span class="p">,</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;filter&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">accept</span><span class="p">(</span><span class="s1">&#39;attrs&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">pipeless</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseTextBlock</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">pipeless</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Filter</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-200"><td class="docs"><div class="pilwrap"><a href="#section-200" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>tag ':' attrs? block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseASTFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">block</span>
      <span class="p">,</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">accept</span><span class="p">(</span><span class="s1">&#39;attrs&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">);</span>
    <span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Filter</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span>
  </pre></div></td></tr><tr id="section-201"><td class="docs"><div class="pilwrap"><a href="#section-201" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>each block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseEach</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;each&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Each</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">node</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-202"><td class="docs"><div class="pilwrap"><a href="#section-202" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>'extends' name</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseExtends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">dirname</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">dirname</span>
      <span class="p">,</span> <span class="nx">basename</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">basename</span>
      <span class="p">,</span> <span class="nx">join</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;the &quot;filename&quot; option is required to extend templates&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;extends&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span>
      <span class="p">,</span> <span class="nx">dir</span> <span class="o">=</span> <span class="nx">dirname</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">filename</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;.jade&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Parser</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">);</span>

    <span class="nx">parser</span><span class="p">.</span><span class="nx">blocks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blocks</span><span class="p">;</span>
    <span class="nx">parser</span><span class="p">.</span><span class="nx">contexts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contexts</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">extending</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">;</span></pre></div></td></tr><tr id="section-203"><td class="docs"><div class="pilwrap"><a href="#section-203" class="pilcrow">&#182;</a></div><p>TODO: null node</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-204"><td class="docs"><div class="pilwrap"><a href="#section-204" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>'block' name block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseBlock</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span>
      <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">()</span>
      <span class="o">:</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Block</span><span class="p">(</span><span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">blocks</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blocks</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">||</span> <span class="nx">block</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-205"><td class="docs"><div class="pilwrap"><a href="#section-205" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>include block?</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseInclude</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">dirname</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">dirname</span>
      <span class="p">,</span> <span class="nx">basename</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">basename</span>
      <span class="p">,</span> <span class="nx">join</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;include&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span>
      <span class="p">,</span> <span class="nx">dir</span> <span class="o">=</span> <span class="nx">dirname</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">filename</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;the &quot;filename&quot; option is required to use includes&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-206"><td class="docs"><div class="pilwrap"><a href="#section-206" class="pilcrow">&#182;</a></div><p>no extension</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!~</span><span class="nx">basename</span><span class="p">(</span><span class="nx">path</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">+=</span> <span class="s1">&#39;.jade&#39;</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-207"><td class="docs"><div class="pilwrap"><a href="#section-207" class="pilcrow">&#182;</a></div><p>non-jade</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.jade&#39;</span> <span class="o">!=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
        <span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Literal</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
     <span class="p">,</span> <span class="nx">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Parser</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">(</span><span class="nx">parser</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">();</span>
    <span class="nx">ast</span><span class="p">.</span><span class="nx">filename</span> <span class="o">=</span> <span class="nx">path</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ast</span><span class="p">.</span><span class="nx">lastBlock</span><span class="p">().</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">ast</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-208"><td class="docs"><div class="pilwrap"><a href="#section-208" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>mixin block</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseMixin</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;mixin&#39;</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">val</span>
      <span class="p">,</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span>
      <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">()</span>
      <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Mixin</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">block</span><span class="p">);</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-209"><td class="docs"><div class="pilwrap"><a href="#section-209" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>indent (text | newline)* outdent</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">parseTextBlock</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Text</span><span class="p">;</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">spaces</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kc">null</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">_spaces</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_spaces</span> <span class="o">=</span> <span class="nx">spaces</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">indent</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">spaces</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">_spaces</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="s1">&#39;outdent&#39;</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">&#39;newline&#39;</span><span class="o">:</span>
          <span class="nx">text</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;indent&#39;</span><span class="o">:</span>
          <span class="nx">text</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">parseTextBlock</span><span class="p">().</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
            <span class="nx">text</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
          <span class="p">});</span>
          <span class="nx">text</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;\\n&#39;</span><span class="p">);</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
          <span class="nx">text</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">indent</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">().</span><span class="nx">val</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">spaces</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">_spaces</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_spaces</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;outdent&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">text</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-210"><td class="docs"><div class="pilwrap"><a href="#section-210" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>indent expr* outdent</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">block</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Block</span><span class="p">;</span>
    <span class="nx">block</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="s1">&#39;outdent&#39;</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;newline&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">block</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parseExpr</span><span class="p">());</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;outdent&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">block</span><span class="p">;</span>
  <span class="p">},</span></pre></div></td></tr><tr id="section-211"><td class="docs"><div class="pilwrap"><a href="#section-211" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>tag (attrs | class | id)* (text | code | ':')? newline* block?</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  
  <span class="nx">parseTag</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span></pre></div></td></tr><tr id="section-212"><td class="docs"><div class="pilwrap"><a href="#section-212" class="pilcrow">&#182;</a></div><p>ast-filter look-ahead</p>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;attrs&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">)</span> <span class="o">++</span><span class="nx">i</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;:&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">lookahead</span><span class="p">(</span><span class="o">++</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseASTFilter</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">().</span><span class="nx">val</span>
      <span class="p">,</span> <span class="nx">tag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Tag</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">dot</span><span class="p">;</span>

    <span class="nx">tag</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">();</span></pre></div></td></tr><tr id="section-213"><td class="docs"><div class="pilwrap"><a href="#section-213" class="pilcrow">&#182;</a></div><p>(attrs | class | id)*</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">out</span><span class="o">:</span>
      <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s1">&#39;id&#39;</span><span class="o">:</span>
          <span class="k">case</span> <span class="s1">&#39;class&#39;</span><span class="o">:</span>
            <span class="kd">var</span> <span class="nx">tok</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
            <span class="nx">tag</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">tok</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">tok</span><span class="p">.</span><span class="nx">val</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
            <span class="k">continue</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;attrs&#39;</span><span class="o">:</span>
            <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">().</span><span class="nx">attrs</span>
              <span class="p">,</span> <span class="nx">names</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
              <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">names</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
                <span class="p">,</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
              <span class="nx">tag</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">continue</span><span class="p">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="k">break</span> <span class="nx">out</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span></pre></div></td></tr><tr id="section-214"><td class="docs"><div class="pilwrap"><a href="#section-214" class="pilcrow">&#182;</a></div><p>check immediate '.'</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">dot</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-215"><td class="docs"><div class="pilwrap"><a href="#section-215" class="pilcrow">&#182;</a></div><p>(text | code | ':')?</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s1">&#39;text&#39;</span><span class="o">:</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseText</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;code&#39;</span><span class="o">:</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">code</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseCode</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;:&#39;</span><span class="o">:</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">Block</span><span class="p">;</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parseTag</span><span class="p">());</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-216"><td class="docs"><div class="pilwrap"><a href="#section-216" class="pilcrow">&#182;</a></div><p>newline*</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">while</span> <span class="p">(</span><span class="s1">&#39;newline&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">advance</span><span class="p">();</span>

    <span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span> <span class="o">||</span> <span class="o">~</span><span class="nx">textOnly</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span></pre></div></td></tr><tr id="section-217"><td class="docs"><div class="pilwrap"><a href="#section-217" class="pilcrow">&#182;</a></div><p>script special-case</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;script&#39;</span> <span class="o">==</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dot</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="o">!=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^[&#39;&quot;]|[&#39;&quot;]$/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-218"><td class="docs"><div class="pilwrap"><a href="#section-218" class="pilcrow">&#182;</a></div><p>block?</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;indent&#39;</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">textOnly</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">pipeless</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">tag</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseTextBlock</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lexer</span><span class="p">.</span><span class="nx">pipeless</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">block</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">block</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tag</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">block</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">tag</span><span class="p">.</span><span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">tag</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: parser.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;runtime.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-219"><td class="docs"><div class="pilwrap"><a href="#section-219" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - runtime<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#109;&#97;&#x69;&#108;&#x74;&#x6F;:&#116;&#x6A;&#x40;&#x76;&#x69;&#x73;&#x69;&#x6F;n&#x2D;&#109;&#x65;&#x64;&#105;&#x61;&#x2E;&#x63;&#x61;">&#116;&#x6A;&#x40;&#x76;&#x69;&#x73;&#x69;&#x6F;n&#x2D;&#109;&#x65;&#x64;&#105;&#x61;&#x2E;&#x63;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-220"><td class="docs"><div class="pilwrap"><a href="#section-220" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Lame Array.isArray() polyfill for now.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">){</span>
    <span class="k">return</span> <span class="s1">&#39;[object Array]&#39;</span> <span class="o">==</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">}</span></pre></div></td></tr><tr id="section-221"><td class="docs"><div class="pilwrap"><a href="#section-221" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Lame Object.keys() polyfill for now.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
  <span class="p">}</span> 
<span class="p">}</span></pre></div></td></tr><tr id="section-222"><td class="docs"><div class="pilwrap"><a href="#section-222" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Render the given attributes object.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>obj </span><span class="dox_type">Object</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">attrs</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">buf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">,</span> <span class="nx">terse</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">terse</span><span class="p">;</span>
  <span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">terse</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
        <span class="p">,</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">val</span> <span class="o">||</span> <span class="kc">null</span> <span class="o">==</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">terse</span>
            <span class="o">?</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
            <span class="o">:</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;class&#39;</span> <span class="o">==</span> <span class="nx">key</span> <span class="o">&amp;&amp;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">val</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">buf</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">buf</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-223"><td class="docs"><div class="pilwrap"><a href="#section-223" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Escape the given string of <code>html</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>html </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
  <span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;(?!\w+;)/g</span><span class="p">,</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;quot;&#39;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-224"><td class="docs"><div class="pilwrap"><a href="#section-224" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Re-throw the given <code>err</code> in context to the<br />the jade in <code>filename</code> at the given <code>lineno</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>err </span><span class="dox_type">Error</span></div><div class="dox_tag_detail"><span>filename </span><span class="dox_type">String</span></div><div class="dox_tag_detail"><span>lineno </span><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">rethrow</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">rethrow</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">filename</span><span class="p">,</span> <span class="nx">lineno</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">filename</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">start</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">lineno</span> <span class="o">-</span> <span class="nx">context</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">end</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">lineno</span> <span class="o">+</span> <span class="nx">context</span><span class="p">);</span> </pre></div></td></tr><tr id="section-225"><td class="docs"><div class="pilwrap"><a href="#section-225" class="pilcrow">&#182;</a></div><p>Error context</p>
</td><td class="code"><div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">i</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">curr</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">curr</span> <span class="o">==</span> <span class="nx">lineno</span> <span class="o">?</span> <span class="s1">&#39;  &gt; &#39;</span> <span class="o">:</span> <span class="s1">&#39;    &#39;</span><span class="p">)</span>
      <span class="o">+</span> <span class="nx">curr</span>
      <span class="o">+</span> <span class="s1">&#39;| &#39;</span>
      <span class="o">+</span> <span class="nx">line</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-226"><td class="docs"><div class="pilwrap"><a href="#section-226" class="pilcrow">&#182;</a></div><p>Alter exception message</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">err</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">;</span>
  <span class="nx">err</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="p">(</span><span class="nx">filename</span> <span class="o">||</span> <span class="s1">&#39;Jade&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">lineno</span> 
    <span class="o">+</span> <span class="s1">&#39;\n&#39;</span> <span class="o">+</span> <span class="nx">context</span> <span class="o">+</span> <span class="s1">&#39;\n\n&#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
  <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
<span class="p">};</span>

<span class="p">});</span> <span class="c1">// module: runtime.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;self-closing.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-227"><td class="docs"><div class="pilwrap"><a href="#section-227" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - self closing tags<br />Copyright(c) 2010 TJ Holowaychuk <a href="m&#97;i&#108;t&#111;:t&#x6A;&#64;&#118;&#105;&#115;&#105;&#111;&#x6E;&#45;m&#x65;&#100;&#105;&#97;&#46;&#99;&#x61;">t&#x6A;&#64;&#118;&#105;&#115;&#105;&#111;&#x6E;&#45;m&#x65;&#100;&#105;&#97;&#46;&#99;&#x61;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;meta&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;img&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;link&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;input&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;area&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;base&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;col&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;br&#39;</span>
  <span class="p">,</span> <span class="s1">&#39;hr&#39;</span>
<span class="p">];</span>
<span class="p">});</span> <span class="c1">// module: self-closing.js</span>

<span class="nx">require</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;utils.js&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">){</span></pre></div></td></tr><tr id="section-228"><td class="docs"><div class="pilwrap"><a href="#section-228" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Jade - utils<br />Copyright(c) 2010 TJ Holowaychuk <a href="&#x6D;&#x61;&#x69;&#108;&#116;&#111;:&#116;&#x6A;&#64;&#118;is&#x69;&#111;&#x6E;&#x2D;m&#101;&#x64;&#105;&#97;&#46;&#99;&#97;">&#116;&#x6A;&#64;&#118;is&#x69;&#111;&#x6E;&#x2D;m&#101;&#x64;&#105;&#97;&#46;&#99;&#97;</a><br />MIT Licensed</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-229"><td class="docs"><div class="pilwrap"><a href="#section-229" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Convert interpolation in the given string to JavaScript.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">interpolate</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">interpolate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(\\)?([#!]){(.*?)}/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">escape</span><span class="p">,</span> <span class="nx">flag</span><span class="p">,</span> <span class="nx">code</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">escape</span>
      <span class="o">?</span> <span class="nx">str</span>
      <span class="o">:</span> <span class="s2">&quot;&#39; + &quot;</span>
        <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;!&#39;</span> <span class="o">==</span> <span class="nx">flag</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;escape&#39;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;((interp = &quot;</span> <span class="o">+</span> <span class="nx">code</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\&#39;/g</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;) == null ? &#39;&#39; : interp) + &#39;&quot;</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-230"><td class="docs"><div class="pilwrap"><a href="#section-230" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Escape single quotes in <code>str</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">escape</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span> <span class="s2">&quot;\\&#39;&quot;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-231"><td class="docs"><div class="pilwrap"><a href="#section-231" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Interpolate, and escape the given <code>str</code>.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>str </span><span class="dox_type">String</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">String</span></div><div class="dox_tag_title">API</div><div class="dox_tag_detail"><span class="dox_type">private</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">escape</span><span class="p">(</span><span class="nx">str</span><span class="p">));</span>
<span class="p">};</span>
<span class="p">});</span> <span class="c1">// module: utils.js</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Fri Jan 04 2013 21:20:41 GMT+0100 (CET)  </div></div></body></html>